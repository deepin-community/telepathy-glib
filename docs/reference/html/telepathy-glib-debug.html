<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Common debug support: telepathy-glib API Reference Manual</title>
<meta name="generator" content="DocBook XSL Stylesheets V1.79.1">
<link rel="home" href="index.html" title="telepathy-glib API Reference Manual">
<link rel="up" href="ch-utilities.html" title="Utilities">
<link rel="prev" href="telepathy-glib-gnio-util.html" title="GNIO Utilities">
<link rel="next" href="telepathy-glib-debug-sender.html" title="TpDebugSender">
<meta name="generator" content="GTK-Doc V1.32 (XML mode)">
<link rel="stylesheet" href="style.css" type="text/css">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table class="navigation" id="top" width="100%" summary="Navigation header" cellpadding="2" cellspacing="5"><tr valign="middle">
<td width="100%" align="left" class="shortcuts">
<a href="#" class="shortcut">Top</a><span id="nav_description">  <span class="dim">|</span> 
                  <a href="#telepathy-glib-debug.description" class="shortcut">Description</a></span>
</td>
<td><a accesskey="h" href="index.html"><img src="home.png" width="16" height="16" border="0" alt="Home"></a></td>
<td><a accesskey="u" href="ch-utilities.html"><img src="up.png" width="16" height="16" border="0" alt="Up"></a></td>
<td><a accesskey="p" href="telepathy-glib-gnio-util.html"><img src="left.png" width="16" height="16" border="0" alt="Prev"></a></td>
<td><a accesskey="n" href="telepathy-glib-debug-sender.html"><img src="right.png" width="16" height="16" border="0" alt="Next"></a></td>
</tr></table>
<div class="refentry">
<a name="telepathy-glib-debug"></a><div class="titlepage"></div>
<div class="refnamediv"><table width="100%"><tr>
<td valign="top">
<h2><span class="refentrytitle"><a name="telepathy-glib-debug.top_of_page"></a>Common debug support</span></h2>
<p>Common debug support — API to activate debugging messages from telepathy-glib</p>
</td>
<td class="gallery_image" valign="top" align="right"></td>
</tr></table></div>
<div class="refsect1">
<a name="telepathy-glib-debug.functions"></a><h2>Functions</h2>
<div class="informaltable"><table class="informaltable" width="100%" border="0">
<colgroup>
<col width="150px" class="functions_proto_type">
<col class="functions_proto_name">
</colgroup>
<tbody>
<tr>
<td class="function_type">
<span class="returnvalue">void</span>
</td>
<td class="function_name">
<a class="link" href="telepathy-glib-debug.html#tp-debug-set-flags" title="tp_debug_set_flags ()">tp_debug_set_flags</a> <span class="c_punctuation">()</span>
</td>
</tr>
<tr>
<td class="function_type">
<span class="returnvalue">void</span>
</td>
<td class="function_name">
<a class="link" href="telepathy-glib-debug.html#tp-debug-set-persistent" title="tp_debug_set_persistent ()">tp_debug_set_persistent</a> <span class="c_punctuation">()</span>
</td>
</tr>
<tr>
<td class="function_type">
<span class="returnvalue">void</span>
</td>
<td class="function_name">
<a class="link" href="telepathy-glib-debug.html#tp-debug-divert-messages" title="tp_debug_divert_messages ()">tp_debug_divert_messages</a> <span class="c_punctuation">()</span>
</td>
</tr>
<tr>
<td class="function_type">
<span class="returnvalue">void</span>
</td>
<td class="function_name">
<a class="link" href="telepathy-glib-debug.html#tp-debug-timestamped-log-handler" title="tp_debug_timestamped_log_handler ()">tp_debug_timestamped_log_handler</a> <span class="c_punctuation">()</span>
</td>
</tr>
<tr>
<td class="function_type">
<span class="returnvalue">void</span>
</td>
<td class="function_name">
<a class="link" href="telepathy-glib-debug.html#tp-debug-set-flags-from-string" title="tp_debug_set_flags_from_string ()">tp_debug_set_flags_from_string</a> <span class="c_punctuation">()</span>
</td>
</tr>
<tr>
<td class="function_type">
<span class="returnvalue">void</span>
</td>
<td class="function_name">
<a class="link" href="telepathy-glib-debug.html#tp-debug-set-flags-from-env" title="tp_debug_set_flags_from_env ()">tp_debug_set_flags_from_env</a> <span class="c_punctuation">()</span>
</td>
</tr>
<tr>
<td class="function_type">
<span class="returnvalue">void</span>
</td>
<td class="function_name">
<a class="link" href="telepathy-glib-debug.html#tp-debug-set-all-flags" title="tp_debug_set_all_flags ()">tp_debug_set_all_flags</a> <span class="c_punctuation">()</span>
</td>
</tr>
</tbody>
</table></div>
</div>
<div class="refsect1">
<a name="telepathy-glib-debug.includes"></a><h2>Includes</h2>
<pre class="synopsis">#include &lt;telepathy-glib/telepathy-glib.h&gt;
</pre>
</div>
<div class="refsect1">
<a name="telepathy-glib-debug.description"></a><h2>Description</h2>
<p>telepathy-glib has an internal mechanism for debug messages and filtering.
Connection managers written with telepathy-glib are expected to connect
this to their own debugging mechanisms: when the CM's debugging mechanism
is activated, it should call <a class="link" href="telepathy-glib-debug.html#tp-debug-set-flags" title="tp_debug_set_flags ()"><code class="function">tp_debug_set_flags()</code></a> and/or
<a class="link" href="telepathy-glib-debug.html#tp-debug-set-persistent" title="tp_debug_set_persistent ()"><code class="function">tp_debug_set_persistent()</code></a>.</p>
<p>The supported debug-mode keywords and the debug messages that they enable
are subject to change, but currently include:</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem">
<code class="literal">misc</code> - low-level utility code</li>
<li class="listitem">
<code class="literal">manager</code> -
   <a class="link" href="telepathy-glib-connection-manager.html#TpConnectionManager"><span class="type">TpConnectionManager</span></a> (client)</li>
<li class="listitem">
<code class="literal">connection</code> - <a class="link" href="TpBaseConnection.html" title="TpBaseConnection"><span class="type">TpBaseConnection</span></a> (service)
   and <a class="link" href="telepathy-glib-connection.html#TpConnection"><span class="type">TpConnection</span></a> (client)</li>
<li class="listitem">
<code class="literal">contacts</code> - <a class="link" href="telepathy-glib-contact.html#TpContact"><span class="type">TpContact</span></a> objects
   (client)</li>
<li class="listitem">
<code class="literal">channel</code> - <a class="link" href="telepathy-glib-channel.html#TpChannel"><span class="type">TpChannel</span></a> (client)</li>
<li class="listitem">
<code class="literal">im</code> - (text) instant messaging
   (service)</li>
<li class="listitem">
<code class="literal">properties</code> -
   <a class="link" href="telepathy-glib-dbus-properties-mixin.html" title="TpDBusPropertiesMixin">TpDBusPropertiesMixin</a> and <a class="link" href="telepathy-glib-TpPropertiesMixin.html#TpPropertiesMixin" title="struct TpPropertiesMixin"><span class="type">TpPropertiesMixin</span></a> (service)</li>
<li class="listitem">
<code class="literal">params</code> - connection manager parameters
   (service)</li>
<li class="listitem">
<code class="literal">handles</code> - handle reference tracking tracking
   in <a class="link" href="TpBaseConnection.html" title="TpBaseConnection"><span class="type">TpBaseConnection</span></a> (service) and <a class="link" href="telepathy-glib-connection.html#TpConnection"><span class="type">TpConnection</span></a> (client)</li>
<li class="listitem">
<code class="literal">accounts</code> - the <a class="link" href="telepathy-glib-account-manager.html#TpAccountManager"><span class="type">TpAccountManager</span></a> and
    <a class="link" href="telepathy-glib-account.html#TpAccount"><span class="type">TpAccount</span></a> objects (client)</li>
<li class="listitem">
<code class="literal">contact-lists</code> - the <a class="link" href="telepathy-glib-base-contact-list.html#TpBaseContactList"><span class="type">TpBaseContactList</span></a>
   (service)</li>
<li class="listitem">
<code class="literal">debugger</code> - <a class="link" href="TpDebugClient.html" title="TpDebugClient"><span class="type">TpDebugClient</span></a> objects</li>
<li class="listitem">
<code class="literal">tls</code> - <a class="link" href="TpTLSCertificate.html" title="TpTLSCertificate"><span class="type">TpTLSCertificate</span></a> objects
    (client)</li>
<li class="listitem">
<code class="literal">all</code> - all of the above</li>
</ul></div>
</div>
<div class="refsect1">
<a name="telepathy-glib-debug.functions_details"></a><h2>Functions</h2>
<div class="refsect2">
<a name="tp-debug-set-flags"></a><h3>tp_debug_set_flags ()</h3>
<pre class="programlisting"><span class="returnvalue">void</span>
tp_debug_set_flags (<em class="parameter"><code>const <span class="type">gchar</span> *flags_string</code></em>);</pre>
<p>Set the debug flags indicated by <em class="parameter"><code>flags_string</code></em>
, in addition to any already
set.</p>
<p>The parsing matches that of <code class="function">g_parse_debug_string()</code>.</p>
<p>If telepathy-glib was compiled with --disable-debug (not recommended),
this function has no practical effect, since the debug messages it would
enable were removed at compile time.</p>
<div class="refsect3">
<a name="tp-debug-set-flags.parameters"></a><h4>Parameters</h4>
<div class="informaltable"><table class="informaltable" width="100%" border="0">
<colgroup>
<col width="150px" class="parameters_name">
<col class="parameters_description">
<col width="200px" class="parameters_annotations">
</colgroup>
<tbody><tr>
<td class="parameter_name"><p>flags_string</p></td>
<td class="parameter_description"><p>The flags to set, comma-separated. If <code class="literal">NULL</code> or empty,
no additional flags are set.</p></td>
<td class="parameter_annotations"> </td>
</tr></tbody>
</table></div>
</div>
<p class="since">Since: 0.6.1</p>
</div>
<hr>
<div class="refsect2">
<a name="tp-debug-set-persistent"></a><h3>tp_debug_set_persistent ()</h3>
<pre class="programlisting"><span class="returnvalue">void</span>
tp_debug_set_persistent (<em class="parameter"><code><span class="type">gboolean</span> persistent</code></em>);</pre>
<p>Used to enable persistent operation of the connection manager process for
debugging purposes.</p>
<div class="refsect3">
<a name="tp-debug-set-persistent.parameters"></a><h4>Parameters</h4>
<div class="informaltable"><table class="informaltable" width="100%" border="0">
<colgroup>
<col width="150px" class="parameters_name">
<col class="parameters_description">
<col width="200px" class="parameters_annotations">
</colgroup>
<tbody><tr>
<td class="parameter_name"><p>persistent</p></td>
<td class="parameter_description"><p>TRUE prevents the connection manager mainloop from exiting,
FALSE enables exiting if there are no connections
(the default behavior).</p></td>
<td class="parameter_annotations"> </td>
</tr></tbody>
</table></div>
</div>
</div>
<hr>
<div class="refsect2">
<a name="tp-debug-divert-messages"></a><h3>tp_debug_divert_messages ()</h3>
<pre class="programlisting"><span class="returnvalue">void</span>
tp_debug_divert_messages (<em class="parameter"><code>const <span class="type">gchar</span> *filename</code></em>);</pre>
<p>Open the given file for writing and duplicate its file descriptor to
be used for stdout and stderr. This has the effect of closing the previous
stdout and stderr, and sending all messages that would have gone there
to the given file instead.</p>
<p>By default the file is truncated and hence overwritten each time the
process is executed.
Since version 0.7.14, if the filename is prefixed with '+' then the
file is not truncated and output is added at the end of the file.</p>
<p>Passing <code class="literal">NULL</code> to this function is guaranteed to have no effect. This is
so you can call it with the recommended usage
<code class="literal">tp_debug_divert_messages (g_getenv ("MYAPP_LOGFILE"))</code>
and it won't do anything if the environment variable is not set.</p>
<p>This function still works if telepathy-glib was compiled without debug
support.</p>
<div class="refsect3">
<a name="tp-debug-divert-messages.parameters"></a><h4>Parameters</h4>
<div class="informaltable"><table class="informaltable" width="100%" border="0">
<colgroup>
<col width="150px" class="parameters_name">
<col class="parameters_description">
<col width="200px" class="parameters_annotations">
</colgroup>
<tbody><tr>
<td class="parameter_name"><p>filename</p></td>
<td class="parameter_description"><p>A file to which to divert stdout and stderr, or <code class="literal">NULL</code> to
do nothing</p></td>
<td class="parameter_annotations"> </td>
</tr></tbody>
</table></div>
</div>
<p class="since">Since: 0.7.1</p>
</div>
<hr>
<div class="refsect2">
<a name="tp-debug-timestamped-log-handler"></a><h3>tp_debug_timestamped_log_handler ()</h3>
<pre class="programlisting"><span class="returnvalue">void</span>
tp_debug_timestamped_log_handler (<em class="parameter"><code>const <span class="type">gchar</span> *log_domain</code></em>,
                                  <em class="parameter"><code><span class="type">GLogLevelFlags</span> log_level</code></em>,
                                  <em class="parameter"><code>const <span class="type">gchar</span> *message</code></em>,
                                  <em class="parameter"><code><span class="type">gpointer</span> ignored</code></em>);</pre>
<p>A <span class="type">GLogFunc</span> that prepends the UTC time (currently in ISO 8601 format,
with microsecond resolution) to the message, then calls
g_log_default_handler.</p>
<p>Intended usage is:</p>
<div class="informalexample">
  <table class="listing_frame" border="0" cellpadding="0" cellspacing="0">
    <tbody>
      <tr>
        <td class="listing_lines" align="right"><pre>1
2</pre></td>
        <td class="listing_code"><pre class="programlisting"><span class="k">if</span> <span class="p">(</span><span class="n">g_getenv</span> <span class="p">(</span><span class="s">&quot;MYPROG_TIMING&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">)</span>
  <span class="n">g_log_set_default_handler</span> <span class="p">(</span><span class="n">tp_debug_timestamped_log_handler</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span></pre></td>
      </tr>
    </tbody>
  </table>
</div>

<p>If telepathy-glib was compiled with --disable-debug (not recommended),
this function is equivalent to <code class="function">g_log_default_handler()</code>.</p>
<p>Changed in 0.9.0: timestamps are now printed in UTC, in
RFC-3339 format. Previously, they were printed in local time, in a
format similar to RFC-3339.</p>
<div class="refsect3">
<a name="tp-debug-timestamped-log-handler.parameters"></a><h4>Parameters</h4>
<div class="informaltable"><table class="informaltable" width="100%" border="0">
<colgroup>
<col width="150px" class="parameters_name">
<col class="parameters_description">
<col width="200px" class="parameters_annotations">
</colgroup>
<tbody>
<tr>
<td class="parameter_name"><p>log_domain</p></td>
<td class="parameter_description"><p>the message's log domain</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>log_level</p></td>
<td class="parameter_description"><p>the log level of the message</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>message</p></td>
<td class="parameter_description"><p>the message to process</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>ignored</p></td>
<td class="parameter_description"><p>not used</p></td>
<td class="parameter_annotations"> </td>
</tr>
</tbody>
</table></div>
</div>
<p class="since">Since: 0.7.1</p>
</div>
<hr>
<div class="refsect2">
<a name="tp-debug-set-flags-from-string"></a><h3>tp_debug_set_flags_from_string ()</h3>
<pre class="programlisting"><span class="returnvalue">void</span>
tp_debug_set_flags_from_string (<em class="parameter"><code>const <span class="type">gchar</span> *flags_string</code></em>);</pre>
<div class="warning">
<p><code class="literal">tp_debug_set_flags_from_string</code> is deprecated and should not be used in newly-written code.</p>
<p>since 0.6.1. Use <a class="link" href="telepathy-glib-debug.html#tp-debug-set-flags" title="tp_debug_set_flags ()"><code class="function">tp_debug_set_flags()</code></a> and
<a class="link" href="telepathy-glib-debug.html#tp-debug-set-persistent" title="tp_debug_set_persistent ()"><code class="function">tp_debug_set_persistent()</code></a> instead</p>
</div>
<p>Set the debug flags indicated by <em class="parameter"><code>flags_string</code></em>
, in addition to any already
set. Unlike <a class="link" href="telepathy-glib-debug.html#tp-debug-set-flags" title="tp_debug_set_flags ()"><code class="function">tp_debug_set_flags()</code></a>, this enables persistence like
<a class="link" href="telepathy-glib-debug.html#tp-debug-set-persistent" title="tp_debug_set_persistent ()"><code class="function">tp_debug_set_persistent()</code></a> if the "persist" flag is present or the string
is "all" - this turns out to be unhelpful, as persistence should be
orthogonal.</p>
<p>The parsing matches that of <code class="function">g_parse_debug_string()</code>.</p>
<p><span class="annotation">[<acronym title="Exposed in C code, not necessarily available in other languages."><span class="acronym">skip</span></acronym>]</span></p>
<div class="refsect3">
<a name="tp-debug-set-flags-from-string.parameters"></a><h4>Parameters</h4>
<div class="informaltable"><table class="informaltable" width="100%" border="0">
<colgroup>
<col width="150px" class="parameters_name">
<col class="parameters_description">
<col width="200px" class="parameters_annotations">
</colgroup>
<tbody><tr>
<td class="parameter_name"><p>flags_string</p></td>
<td class="parameter_description"><p>The flags to set, comma-separated. If <code class="literal">NULL</code> or empty,
no additional flags are set.</p></td>
<td class="parameter_annotations"> </td>
</tr></tbody>
</table></div>
</div>
</div>
<hr>
<div class="refsect2">
<a name="tp-debug-set-flags-from-env"></a><h3>tp_debug_set_flags_from_env ()</h3>
<pre class="programlisting"><span class="returnvalue">void</span>
tp_debug_set_flags_from_env (<em class="parameter"><code>const <span class="type">gchar</span> *var</code></em>);</pre>
<div class="warning">
<p><code class="literal">tp_debug_set_flags_from_env</code> is deprecated and should not be used in newly-written code.</p>
<p>since 0.6.1. Use tp_debug_set_flags(g_getenv(...)) and
<a class="link" href="telepathy-glib-debug.html#tp-debug-set-persistent" title="tp_debug_set_persistent ()"><code class="function">tp_debug_set_persistent()</code></a> instead</p>
</div>
<p>Equivalent to
<code class="literal">tp_debug_set_flags_from_string (g_getenv (var))</code>,
and has the same problem with persistence being included in "all".</p>
<p><span class="annotation">[<acronym title="Exposed in C code, not necessarily available in other languages."><span class="acronym">skip</span></acronym>]</span></p>
<div class="refsect3">
<a name="tp-debug-set-flags-from-env.parameters"></a><h4>Parameters</h4>
<div class="informaltable"><table class="informaltable" width="100%" border="0">
<colgroup>
<col width="150px" class="parameters_name">
<col class="parameters_description">
<col width="200px" class="parameters_annotations">
</colgroup>
<tbody><tr>
<td class="parameter_name"><p>var</p></td>
<td class="parameter_description"><p>The name of the environment variable to parse</p></td>
<td class="parameter_annotations"> </td>
</tr></tbody>
</table></div>
</div>
</div>
<hr>
<div class="refsect2">
<a name="tp-debug-set-all-flags"></a><h3>tp_debug_set_all_flags ()</h3>
<pre class="programlisting"><span class="returnvalue">void</span>
tp_debug_set_all_flags (<em class="parameter"><code><span class="type">void</span></code></em>);</pre>
<div class="warning">
<p><code class="literal">tp_debug_set_all_flags</code> is deprecated and should not be used in newly-written code.</p>
<p>since 0.6.1. Use tp_debug_set_flags ("all") and
<a class="link" href="telepathy-glib-debug.html#tp-debug-set-persistent" title="tp_debug_set_persistent ()"><code class="function">tp_debug_set_persistent()</code></a> instead.</p>
</div>
<p>Activate all possible debug modes. This also activates persistent mode,
which should have been orthogonal.</p>
<p><span class="annotation">[<acronym title="Exposed in C code, not necessarily available in other languages."><span class="acronym">skip</span></acronym>]</span></p>
</div>
</div>
</div>
<div class="footer">
<hr>Generated by GTK-Doc V1.32</div>
</body>
</html>